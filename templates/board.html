<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Team Task Dashboard</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #e0f7fa 0, #f3e5f5 45%, #fff 80%);
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 24px;
      color: #1f2933;
    }

    .app {
      background: #ffffff;
      width: 100%;
      max-width: 1100px;
      min-height: 520px;
      border-radius: 18px;
      box-shadow:
        0 18px 45px rgba(15, 23, 42, 0.18),
        0 0 0 1px rgba(148, 163, 184, 0.3);
      display: flex;
      overflow: hidden;
      border: 1px solid rgba(148, 163, 184, 0.35);
    }

    /* SIDEBAR */

    .sidebar {
      width: 30%;
      background: linear-gradient(160deg, #0f766e 0%, #22c55e 55%, #facc15 110%);
      padding: 18px 16px;
      color: #ecfdf5;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .sidebar-header {
      display: flex;
      flex-direction: column;
      gap: 4px;
      align-items: center;
      text-align: center;
    }

    h1 {
      margin: 0;
      font-size: 22px;
      font-weight: 700;
      letter-spacing: 0.03em;
      text-transform: uppercase;
    }

    .subtitle {
      font-size: 12px;
      opacity: 0.9;
    }

    .tag-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 9px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.16);
      font-size: 11px;
      margin-top: 4px;
    }

    .tag-pill span.dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #bbf7d0;
    }

    .member-list {
      list-style: none;
      padding: 0;
      margin: 4px 0 0;
      display: flex;
      flex-direction: column;
      gap: 8px;
      overflow-y: auto;
    }

    .member-item {
      padding: 10px 12px;
      border-radius: 10px;
      cursor: pointer;
      border: 1px solid transparent;
      display: flex;
      flex-direction: column;
      gap: 2px;
      background: rgba(15, 23, 42, 0.15);
      backdrop-filter: blur(6px);
      transition: all 0.18s ease-out;
    }

    .member-item span.name {
      font-size: 14px;
      font-weight: 600;
      color: #f9fafb;
    }

    .member-item span.role {
      font-size: 12px;
      color: #e5e7eb;
      opacity: 0.9;
    }

    .member-item:hover {
      background: rgba(15, 23, 42, 0.28);
      border-color: rgba(255, 255, 255, 0.6);
      transform: translateY(-1px);
    }

    .member-item.active {
      background: rgba(15, 23, 42, 0.45);
      border-color: #fef9c3;
      box-shadow: 0 0 0 1px rgba(250, 250, 250, 0.3);
    }

    /* MAIN */

    .main {
      width: 70%;
      padding: 20px 22px 22px;
      background: radial-gradient(circle at top left, #e0f2fe 0, #fdf2ff 40%, #ffffff 75%);
      display: flex;
      flex-direction: column;
    }

    .main-header {
      margin-bottom: 14px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 10px;
    }

    .main-header-left .name {
      font-size: 18px;
      font-weight: 700;
      color: #111827;
    }

    .main-header-left .role {
      font-size: 13px;
      color: #6b7280;
      margin-top: 2px;
    }

    .main-header-right {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #6b7280;
      background: rgba(219, 234, 254, 0.9);
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #bfdbfe;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .main-header-right span.dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
    }

    .progress-container {
      margin: 10px 0 14px;
    }

    .progress-label {
      font-size: 13px;
      margin-bottom: 4px;
      color: #4b5563;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .progress-label span.value {
      font-weight: 600;
      font-size: 12px;
      color: #0f766e;
    }

    .progress-bar {
      width: 100%;
      height: 12px;
      background: #e5e7eb;
      border-radius: 999px;
      overflow: hidden;
      box-shadow: inset 0 1px 2px rgba(148, 163, 184, 0.6);
    }

    .progress-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #22c55e, #84cc16, #facc15);
      transition: width 0.25s ease-out;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 0 0 1px rgba(226, 232, 240, 0.8);
      background: #ffffffcf;
      backdrop-filter: blur(4px);
    }

    th, td {
      padding: 8px 8px;
      border-bottom: 1px solid #e5e7eb;
      text-align: left;
    }

    th {
      background: linear-gradient(90deg, #eff6ff, #ecfdf5);
      font-weight: 600;
      color: #374151;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    tr:last-child td {
      border-bottom: none;
    }

    tr:nth-child(even) td {
      background: #f9fafb;
    }

    tr:hover td {
      background: #eef2ff;
    }

    /* Status button pill */

    .status-btn {
      padding: 4px 10px;
      font-size: 12px;
      border-radius: 999px;
      border: 1px solid transparent;
      font-weight: 500;
      cursor: pointer;
      outline: none;
      transition: all 0.18s ease-out;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 90px;
    }

    .status-btn:active {
      transform: scale(0.97);
    }

    .status-done {
      color: #166534;
      font-weight: 600;
      background: #dcfce7;
      border-color: #bbf7d0;
    }

    .status-progress {
      color: #92400e;
      font-weight: 600;
      background: #ffedd5;
      border-color: #fed7aa;
    }

    .status-todo {
      color: #374151;
      font-weight: 500;
      background: #e5e7eb;
      border-color: #d1d5db;
    }

    .empty-state {
      font-size: 13px;
      color: #6b7280;
      text-align: center;
      margin-top: 40px;
    }

    .empty-state span {
      font-size: 20px;
      display: block;
      margin-bottom: 6px;
    }

    @media (max-width: 900px) {
      .app {
        flex-direction: column;
      }
      .sidebar, .main {
        width: 100%;
      }
      .sidebar {
        border-right: none;
        border-bottom: 1px solid rgba(148, 163, 184, 0.4);
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="sidebar">
      <div class="sidebar-header">
        <h1>Team Tasks</h1>
        <div class="subtitle">30-day sprint plan for Farmer App</div>
        <div class="tag-pill">
          <span class="dot"></span>
          <span>Live Progress View</span>
        </div>
      </div>
      <ul class="member-list" id="memberList"></ul>
    </div>

    <div class="main">
      <div id="mainContent">
        <div class="empty-state">
          <span>üëã</span>
          Select a team member on the left to see their tasks.
        </div>
      </div>
    </div>
  </div>

  <script>
    // ====== Static 30-day plan data ======
    const members = [
      {
        id: "vinay",
        name: "Vinay Kumar V",
        role: "Admin Dashboard & Analytics",
        tasks: [
          { day: 1,  title: "Prepare admin feature list", status: "To-Do" },
          { day: 2,  title: "Admin layout template", status: "To-Do" },
          { day: 3,  title: "Dashboard skeleton (structure only)", status: "To-Do" },
          { day: 4,  title: "Crops/Regions UI (static)", status: "To-Do" },
          { day: 5,  title: "Crop plan management UI", status: "To-Do" },
          { day: 6,  title: "Dashboard data design (what metrics to show)", status: "To-Do" },
          { day: 7,  title: "Review week 1 work", status: "To-Do" },
          { day: 8,  title: "Demand entry page", status: "To-Do" },
          { day: 9,  title: "List demand entries", status: "To-Do" },
          { day: 10, title: "Filter UI for demand/crop/region", status: "To-Do" },
          { day: 11, title: "Link admin UI with DB", status: "To-Do" },
          { day: 12, title: "Admin permissions (roles)", status: "To-Do" },
          { day: 13, title: "Summary calculations (totals, averages)", status: "To-Do" },
          { day: 14, title: "Admin integration check", status: "To-Do" },
          { day: 15, title: "Add Chart.js to dashboard", status: "To-Do" },
          { day: 16, title: "Bar chart: Area per crop", status: "To-Do" },
          { day: 17, title: "Pie chart: Crop share distribution", status: "To-Do" },
          { day: 18, title: "Metrics cards (key KPIs)", status: "To-Do" },
          { day: 19, title: "CSV export for reports", status: "To-Do" },
          { day: 20, title: "Layout improvements", status: "To-Do" },
          { day: 21, title: "Analytics testing", status: "To-Do" },
          { day: 22, title: "Fix chart-related bugs", status: "To-Do" },
          { day: 23, title: "Date filter system", status: "To-Do" },
          { day: 24, title: "Data correctness check", status: "To-Do" },
          { day: 25, title: "Usage steps documentation", status: "To-Do" },
          { day: 26, title: "Format validation (tables/exports)", status: "To-Do" },
          { day: 27, title: "UI cleanup & final review", status: "To-Do" },
          { day: 28, title: "Buffer / spillover tasks", status: "To-Do" },
          { day: 29, title: "Bug fixing & final polish", status: "To-Do" },
          { day: 30, title: "Final review & handover", status: "To-Do" }
        ]
      },
      {
        id: "yashwanth",
        name: "Yashwanth H V",
        role: "Backend & Database Engineer",
        tasks: [
          { day: 1,  title: "Setup Django project & MySQL", status: "To-Do" },
          { day: 2,  title: "Create apps (accounts, farmer, adminpanel, recommendation)", status: "To-Do" },
          { day: 3,  title: "Create User & FarmerProfile models + migrations", status: "To-Do" },
          { day: 4,  title: "Crop, Region, Season models + admin register", status: "To-Do" },
          { day: 5,  title: "CropPlan model + relations", status: "To-Do" },
          { day: 6,  title: "Field validations + DB constraints", status: "To-Do" },
          { day: 7,  title: "Code cleanup & review", status: "To-Do" },
          { day: 8,  title: "Authentication backend (login, register)", status: "To-Do" },
          { day: 9,  title: "Farmer dashboard backend logic", status: "To-Do" },
          { day: 10, title: "Save crop plan logic", status: "To-Do" },
          { day: 11, title: "List/Create crop plan API endpoints", status: "To-Do" },
          { day: 12, title: "Add permission checks (farmer vs admin)", status: "To-Do" },
          { day: 13, title: "Backend unit tests", status: "To-Do" },
          { day: 14, title: "API documentation draft", status: "To-Do" },
          { day: 15, title: "Optimize DB queries", status: "To-Do" },
          { day: 16, title: "Improve dashboard data query performance", status: "To-Do" },
          { day: 17, title: "Pagination for long lists", status: "To-Do" },
          { day: 18, title: "Farmer profile edit backend", status: "To-Do" },
          { day: 19, title: "Server-side validation improvements", status: "To-Do" },
          { day: 20, title: "Secure admin-only routes", status: "To-Do" },
          { day: 21, title: "Feature freeze review", status: "To-Do" },
          { day: 22, title: "Bug fixes", status: "To-Do" },
          { day: 23, title: "Create 404 & 500 error pages", status: "To-Do" },
          { day: 24, title: "DB backup test", status: "To-Do" },
          { day: 25, title: "Code refactor", status: "To-Do" },
          { day: 26, title: "Write full API docs", status: "To-Do" },
          { day: 27, title: "Final fixes + review", status: "To-Do" },
          { day: 28, title: "Buffer / spillover tasks", status: "To-Do" },
          { day: 29, title: "Bug fixing & final polish", status: "To-Do" },
          { day: 30, title: "Final review & handover", status: "To-Do" }
        ]
      },
      {
        id: "shashanka",
        name: "Shashanka S",
        role: "Frontend & UI Developer",
        tasks: [
          { day: 1,  title: "Define UI theme & mockups", status: "To-Do" },
          { day: 2,  title: "Create basic HTML/CSS template", status: "To-Do" },
          { day: 3,  title: "Login/Register UI screens", status: "To-Do" },
          { day: 4,  title: "Basic form validations (frontend)", status: "To-Do" },
          { day: 5,  title: "Farmer dashboard layout", status: "To-Do" },
          { day: 6,  title: "Add Crop Plan UI form", status: "To-Do" },
          { day: 7,  title: "UI cleanup review", status: "To-Do" },
          { day: 8,  title: "Connect login/register to backend APIs", status: "To-Do" },
          { day: 9,  title: "Connect Crop Plan form to backend API", status: "To-Do" },
          { day: 10, title: "Table view for crop plans", status: "To-Do" },
          { day: 11, title: "Dynamic crop dropdown (based on DB)", status: "To-Do" },
          { day: 12, title: "Error/success UI messages", status: "To-Do" },
          { day: 13, title: "Stats on dashboard (basic cards)", status: "To-Do" },
          { day: 14, title: "Frontend-backend integration review", status: "To-Do" },
          { day: 15, title: "Add Bootstrap styling", status: "To-Do" },
          { day: 16, title: "Recommendation page UI", status: "To-Do" },
          { day: 17, title: "Badges for suggestions (Good/Balanced/Risk)", status: "To-Do" },
          { day: 18, title: "Profile page UI", status: "To-Do" },
          { day: 19, title: "Mobile responsive testing", status: "To-Do" },
          { day: 20, title: "UX polishing", status: "To-Do" },
          { day: 21, title: "UI freeze", status: "To-Do" },
          { day: 22, title: "UI bug fixes", status: "To-Do" },
          { day: 23, title: "Footer + copyright info", status: "To-Do" },
          { day: 24, title: "UX feedback fixes", status: "To-Do" },
          { day: 25, title: "UI refinements", status: "To-Do" },
          { day: 26, title: "Helper tooltips", status: "To-Do" },
          { day: 27, title: "Final polish & demo-ready UI", status: "To-Do" },
          { day: 28, title: "Buffer / spillover tasks", status: "To-Do" },
          { day: 29, title: "Bug fixing & final polish", status: "To-Do" },
          { day: 30, title: "Final review & handover", status: "To-Do" }
        ]
      },
      {
        id: "lakshmana",
        name: "Lakshmana M R",
        role: "Recommendation Engine & Deployment",
        tasks: [
          { day: 1,  title: "Algorithm research (recommendations)", status: "To-Do" },
          { day: 2,  title: "Data structure plan", status: "To-Do" },
          { day: 3,  title: "Yield value sourcing (per crop)", status: "To-Do" },
          { day: 4,  title: "Pseudo code writing for logic", status: "To-Do" },
          { day: 5,  title: "Create basic functions for recommendation engine", status: "To-Do" },
          { day: 6,  title: "Logic testing with sample data", status: "To-Do" },
          { day: 7,  title: "Review algorithm approach", status: "To-Do" },
          { day: 8,  title: "API response design (JSON format)", status: "To-Do" },
          { day: 9,  title: "API endpoint stub for recommendations", status: "To-Do" },
          { day: 10, title: "Expected supply calculations", status: "To-Do" },
          { day: 11, title: "Shortage/surplus logic", status: "To-Do" },
          { day: 12, title: "Sort recommendations list (priority)", status: "To-Do" },
          { day: 13, title: "Test JSON responses in Postman", status: "To-Do" },
          { day: 14, title: "Review recommendation logic", status: "To-Do" },
          { day: 15, title: "Connect recommendation API to UI", status: "To-Do" },
          { day: 16, title: "Shortage index label logic", status: "To-Do" },
          { day: 17, title: "Crop ranking optimization", status: "To-Do" },
          { day: 18, title: "Fake data generation script", status: "To-Do" },
          { day: 19, title: "Add yield per acre DB support", status: "To-Do" },
          { day: 20, title: "Setup deployment environment", status: "To-Do" },
          { day: 21, title: "Test full system (end-to-end)", status: "To-Do" },
          { day: 22, title: "Performance fixes", status: "To-Do" },
          { day: 23, title: "Secure deployment variables", status: "To-Do" },
          { day: 24, title: "Load testing", status: "To-Do" },
          { day: 25, title: "Setup error logs", status: "To-Do" },
          { day: 26, title: "Final server setup", status: "To-Do" },
          { day: 27, title: "Final checks & launch", status: "To-Do" },
          { day: 28, title: "Buffer / spillover tasks", status: "To-Do" },
          { day: 29, title: "Bug fixing & final polish", status: "To-Do" },
          { day: 30, title: "Final review & handover", status: "To-Do" }
        ]
      }
    ];

    const API_BASE = "/api/tasks/";

    const STATUS_API_TO_LABEL = {
      "todo": "To-Do",
      "in_progress": "In Progress",
      "done": "Done",
    };

    const STATUS_LABEL_TO_API = {
      "To-Do": "todo",
      "In Progress": "in_progress",
      "Done": "done",
    };

    const STATUS_LABELS = ["To-Do", "In Progress", "Done"];

    let allApiTasks = [];
    const memberListEl = document.getElementById("memberList");
    const mainContentEl = document.getElementById("mainContent");

    function getCookie(name) {
      let cookieValue = null;
      if (document.cookie && document.cookie !== "") {
        const cookies = document.cookie.split(";");
        for (let i = 0; i < cookies.length; i++) {
          const cookie = cookies[i].trim();
          if (cookie.substring(0, name.length + 1) === (name + "=")) {
            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
            break;
          }
        }
      }
      return cookieValue;
    }

    async function fetchTasksFromAPI() {
      try {
        const res = await fetch(API_BASE);
        if (!res.ok) throw new Error("API error " + res.status);
        allApiTasks = await res.json();
      } catch (err) {
        console.error("Failed to fetch tasks from API:", err);
        allApiTasks = [];
      }
    }

    // üî• Create or update task in DB
    async function saveTaskToServer(memberId, task) {
      const apiStatus = STATUS_LABEL_TO_API[task.status] || "todo";

      try {
        if (task.apiId) {
          // UPDATE existing task
          await fetch(`${API_BASE}${task.apiId}/`, {
            method: "PATCH",
            headers: {
              "Content-Type": "application/json",
              "X-CSRFToken": getCookie("csrftoken"),
            },
            body: JSON.stringify({
              status: apiStatus,
              day: task.day,
            }),
          });
        } else {
          // CREATE new task on first click
          const res = await fetch(API_BASE, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              "X-CSRFToken": getCookie("csrftoken"),
            },
            body: JSON.stringify({
              title: task.title,
              assignee: memberId,
              status: apiStatus,
              day: task.day,
            }),
          });

          if (res.ok) {
            const data = await res.json();
            task.apiId = data.id; // store id for future PATCH
          } else {
            console.error("Failed to create task:", await res.text());
          }
        }
      } catch (err) {
        console.error("Error saving task:", err);
      }
    }

    function syncApiToStatic() {
      members.forEach(member => {
        const apiTasksForMember = allApiTasks.filter(
          t => t.assignee === member.id
        );
        member.tasks.forEach(task => {
          const match = apiTasksForMember.find(
            t => t.title === task.title
          );
          if (match) {
            task.apiId = match.id;
            if (match.status && STATUS_API_TO_LABEL[match.status]) {
              task.status = STATUS_API_TO_LABEL[match.status];
            }
            if (match.day != null) {
              task.day = match.day;
            }
          } else {
            task.apiId = null;
          }
        });
      });
    }

    function statusClass(status) {
      if (status === "Done") return "status-done";
      if (status === "In Progress") return "status-progress";
      return "status-todo";
    }

    function computeProgress(tasks) {
      if (!tasks.length) return 0;
      const doneCount = tasks.filter(t => t.status === "Done").length;
      return Math.round((doneCount / tasks.length) * 100);
    }

    function renderMemberList() {
      memberListEl.innerHTML = "";
      members.forEach(member => {
        const li = document.createElement("li");
        li.className = "member-item";
        li.dataset.id = member.id;

        const nameSpan = document.createElement("span");
        nameSpan.className = "name";
        nameSpan.textContent = member.name;

        const roleSpan = document.createElement("span");
        roleSpan.className = "role";
        roleSpan.textContent = member.role;

        li.appendChild(nameSpan);
        li.appendChild(roleSpan);

        li.addEventListener("click", () => {
          document.querySelectorAll(".member-item").forEach(item => {
            item.classList.remove("active");
          });
          li.classList.add("active");
          renderMemberDetails(member.id);
        });

        memberListEl.appendChild(li);
      });
    }

    function renderMemberDetails(memberId) {
      const member = members.find(m => m.id === memberId);
      if (!member) return;

      const tasks = member.tasks.slice().sort((a, b) => (a.day || 0) - (b.day || 0));
      const progress = computeProgress(tasks);

      mainContentEl.innerHTML = "";

      const headerDiv = document.createElement("div");
      headerDiv.className = "main-header";

      const left = document.createElement("div");
      left.className = "main-header-left";

      const nameEl = document.createElement("div");
      nameEl.className = "name";
      nameEl.textContent = member.name;

      const roleEl = document.createElement("div");
      roleEl.className = "role";
      roleEl.textContent = member.role;

      left.appendChild(nameEl);
      left.appendChild(roleEl);

      const right = document.createElement("div");
      right.className = "main-header-right";
      const dot = document.createElement("span");
      dot.className = "dot";
      const txt = document.createElement("span");
      txt.textContent = "Sprint Overview";
      right.appendChild(dot);
      right.appendChild(txt);

      headerDiv.appendChild(left);
      headerDiv.appendChild(right);

      const progressContainer = document.createElement("div");
      progressContainer.className = "progress-container";

      const progressLabel = document.createElement("div");
      progressLabel.className = "progress-label";
      const labelLeft = document.createElement("span");
      labelLeft.textContent = "30-day Plan Progress";
      const labelRight = document.createElement("span");
      labelRight.className = "value";
      labelRight.textContent = `${progress}% complete`;
      progressLabel.appendChild(labelLeft);
      progressLabel.appendChild(labelRight);

      const progressBar = document.createElement("div");
      progressBar.className = "progress-bar";

      const progressFill = document.createElement("div");
      progressFill.className = "progress-fill";
      progressFill.style.width = progress + "%";

      progressBar.appendChild(progressFill);
      progressContainer.appendChild(progressLabel);
      progressContainer.appendChild(progressBar);

      const table = document.createElement("table");
      const thead = document.createElement("thead");
      const headerRow = document.createElement("tr");

      ["Day", "Task", "Status"].forEach(text => {
        const th = document.createElement("th");
        th.textContent = text;
        headerRow.appendChild(th);
      });

      thead.appendChild(headerRow);
      table.appendChild(thead);

      const tbody = document.createElement("tbody");

      tasks.forEach(task => {
        const tr = document.createElement("tr");

        const dayTd = document.createElement("td");
        dayTd.textContent =
          task.day != null && task.day !== "" ? `Day ${task.day}` : "-";

        const titleTd = document.createElement("td");
        titleTd.textContent = task.title;

        const statusTd = document.createElement("td");
        const btn = document.createElement("button");
        btn.className = "status-btn " + statusClass(task.status);
        btn.textContent = task.status;

        btn.addEventListener("click", async () => {
          // cycle status
          let idx = STATUS_LABELS.indexOf(task.status);
          if (idx === -1) idx = 0;
          idx = (idx + 1) % STATUS_LABELS.length;
          task.status = STATUS_LABELS[idx];

          btn.textContent = task.status;
          btn.className = "status-btn " + statusClass(task.status);

          const newProgress = computeProgress(tasks);
          progressFill.style.width = newProgress + "%";
          labelRight.textContent = `${newProgress}% complete`;

          // üíæ auto create / update in DB
          await saveTaskToServer(member.id, task);
        });

        statusTd.appendChild(btn);

        tr.appendChild(dayTd);
        tr.appendChild(titleTd);
        tr.appendChild(statusTd);

        tbody.appendChild(tr);
      });

      table.appendChild(tbody);

      mainContentEl.appendChild(headerDiv);
      mainContentEl.appendChild(progressContainer);

      if (tasks.length) {
        mainContentEl.appendChild(table);
      } else {
        const empty = document.createElement("div");
        empty.className = "empty-state";
        empty.innerHTML = "<span>üìù</span>No tasks defined for this member.";
        mainContentEl.appendChild(empty);
      }
    }

    (async function init() {
      renderMemberList();
      await fetchTasksFromAPI();
      syncApiToStatic();

      const first = members[0];
      if (first) {
        const firstLi = document.querySelector(`.member-item[data-id="${first.id}"]`);
        if (firstLi) firstLi.classList.add("active");
        renderMemberDetails(first.id);
      }
    })();
  </script>
</body>
</html>
